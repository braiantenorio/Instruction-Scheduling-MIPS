from django.core.management.base import BaseCommand
from parametroApp.models import Parametro, ReferenciaParametro, CategoriaParametro, ParametroEstudio
from django.utils import timezone
from django.db import connection

class Command(BaseCommand):
    help = 'Inicializa los datos de ejemplo en la base de datos'

    def handle(self, *args, **kwargs):

        ParametroEstudio.objects.all().delete()
        Parametro.objects.all().delete()
        ReferenciaParametro.objects.all().delete()
        CategoriaParametro.objects.all().delete()

        categoria1 = CategoriaParametro.objects.create(
            nombre="Ginecología"
        )

        categoria2 = CategoriaParametro.objects.create(
            nombre="Fetal"
        )

        categoria3 = CategoriaParametro.objects.create(
            nombre="Estándar"
        )

        # Crear referencias para los parámetros
        referencia1 = ReferenciaParametro.objects.create(
            valorMin=35,
            valorMedio=37,
            valorMax=42,
            nombreFormula="Edad gestacional normal en semanas",
            categoriaParametro=categoria1
        )

        referencia2 = ReferenciaParametro.objects.create(
            valorMin=0,
            valorMedio=150,
            valorMax=1000,
            nombreFormula="Volumen uterino normal en centímetros cúbicos",
            categoriaParametro=categoria1
        )

        # Crear parámetros
        parametro1 = Parametro.objects.create(
            tipo="Edad gestacional",
            unidadMedicion="Semanas",
            limiteInferior=0,
            limiteSuperior=42,
            metodoObtencion='M1',
            nombre="Edad gestacional del embarazo",
            parametroReferencia=referencia1,
            categoriaParametro=categoria1
        )

        parametro2 = Parametro.objects.create(
            tipo="Volumen uterino",
            unidadMedicion="Centímetros cúbicos",
            limiteInferior=0,
            limiteSuperior=1000,
            metodoObtencion='M2',
            nombre="Volumen uterino",
            parametroReferencia=referencia2,
            categoriaParametro=categoria1
        )

        parametro3 = Parametro.objects.create(
            tipo="Células anormales en el Papanicolaou",
            unidadMedicion="NA",
            limiteInferior=0,
            limiteSuperior=1,
            metodoObtencion='M3',
            nombre="Resultados anormales en el Papanicolaou",
            parametroReferencia=referencia1,
            categoriaParametro=categoria1
        )

        self.stdout.write(self.style.SUCCESS('Los datos de ejemplo se han creado exitosamente.'))
